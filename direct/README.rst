route of host1, host2

::

   host1.route                              host2.route                       
   destination     gw          dev          Destination     Gateway     Iface                                                          
   10.10.0.0/24    0.0.0.0     eth1         10.10.0.0/24    0.0.0.0     eth1                              
   172.17.1.0/24   0.0.0.0     docker0      172.17.1.0/24   10.10.0.1   eth1                              
   172.17.2.0/24   10.10.0.2   eth1         172.17.1.254    10.10.0.1   eth1                              
   172.17.2.254    10.10.0.2   eth1         172.17.2.0/24   0.0.0.0     docker0                           

network struct

::
                                         
     +--------------------------------------------------------------------------------------------+   
     | host                                                                                       |        
     |                                                                                            |        
     |   +-----------------------------------+          +-----------------------------------+     |        
     |   | host1                             |          |  host2                            |     |        
     |   |      +--------------------+       |          |      +--------------------+       |     |        
     |   |      |con1:ns             |       |          |      |con2:ns             |       |     |        
     |   |      |   172.17.1.1/24    |       |          |      |   172.17.2.1/24    |       |     |        
     |   |      |    +----------+    |       |          |      |    +----------+    |       |     |        
     |   |      +----|   eth0   |----+       |          |      +----|   eth0   |----+       |     |        
     |   |           +----------+            |          |           +----------+            |     |        
     |   |               /|\                 |          |               /|\                 |     |        
     |   |                |                  |          |                |                  |     |        
     |   |               \|/                 |          |               \|/                 |     |        
     |   |           +----------+            |          |           +----------+            |     |        
     |   |      +----|   veth   |----+       |          |      +----|   veth   |----+       |     |        
     |   |      |    +----------+    |       |          |      |    +----------+    |       |     |        
     |   |      |   172.17.1.254/24  |       |          |      |   172.17.1.254/24  |       |     |        
     |   |      | docker0:br         |       |          |      | docker0:br         |       |     |        
     |   |      +--------------------+       |          |      +--------------------+       |     |        
     |   |                                   |          |                                   |     |        
     |   |                                   |          |                                   |     |        
     |   |            10.10.0.1/24           |          |           10.10.0.2/24            |     |        
     |   |           +----------+            |          |           +----------+            |     |        
     |   +-----------|   eth1   |------------+          +-----------|   eth1   |------------+     |        
     |               +----------+                                   +----------+                  |        
     |                   \|/                 +----------+                \|/                      |        
     |                    +------------------|  br0:br  |-----------------+                       |        
     |                                       +----------+                                         |        
     |                                                                                            |        
     +--------------------------------------------------------------------------------------------+   


route of con1, con2

::

   con1.route                               con2.route                                       
   Destination     Gateway         Iface    Destination     Gateway         Iface
   10.10.0.0/24    172.17.1.254    eth0     10.10.0.0/24    172.17.2.254    eth0
   172.17.1.0/24   0.0.0.0         eth0     172.17.1.0/24   172.17.2.254    eth0
   172.17.2.0/24   172.17.1.254    eth0     172.17.1.254    172.17.2.254    eth0
   172.17.2.254    172.17.1.254    eth0     172.17.2.0/24   0.0.0.0         eth0

::

   make init
   make test


test result

::

   ip netns exec con1 ping 172.17.2.1 -c 1
   PING 172.17.2.1 (172.17.2.1) 56(84) bytes of data.
   64 bytes from 172.17.2.1: icmp_seq=1 ttl=62 time=0.097 ms
   
   --- 172.17.2.1 ping statistics ---
   1 packets transmitted, 1 received, 0% packet loss, time 0ms
   rtt min/avg/max/mdev = 0.097/0.097/0.097/0.000 ms
   ip netns exec con2 ping 172.17.1.1 -c 1
   PING 172.17.1.1 (172.17.1.1) 56(84) bytes of data.
   64 bytes from 172.17.1.1: icmp_seq=1 ttl=62 time=0.106 ms
   
   --- 172.17.1.1 ping statistics ---
   1 packets transmitted, 1 received, 0% packet loss, time 0ms
   rtt min/avg/max/mdev = 0.106/0.106/0.106/0.000 ms
